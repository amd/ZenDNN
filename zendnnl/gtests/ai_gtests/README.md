# This test suite has been generated by GHC
# ZenDNNL AI GTests

This folder contains comprehensive Google Test (GTest) suites for validating the ZenDNNL matmul operator and related functionality. The tests are designed to maximize code coverage, robustness, and numerical stability across all supported data types and post-operations, with a special focus on BF16 edge cases and invalid scenarios.

## Test Categories
- **Accuracy Tests**: Validate matmul output against reference implementations for all supported data type combinations (FP32, BF16, INT8, etc.). These tests ensure that the ZenDNNL kernel produces numerically correct results by comparing outputs to a trusted reference implementation. Coverage includes a wide range of matrix shapes, post-operations, and exhaustive parameter combinations. Accuracy tests also check for element-wise correctness within defined tolerances and report any mismatches or failures.
- **Boundary Tests**: Stress-test numerical stability and robustness for extreme matrix dimensions, including very small (e.g., 1x1x1) and very large sizes, SIMD alignment boundaries, cache line boundaries, and hardware-specific edge cases. These tests are designed to expose issues such as overflow, underflow, NaN/Inf generation, and precision loss. Boundary tests validate that the kernel maintains correct behavior and reasonable output values under all supported input sizes and configurations.
- **Edge Case Tests**: Cover minimal, degenerate, and irregular tensor shapes, such as 1x1x1, non-power-of-2 dimensions, highly asymmetric matrices (e.g., very tall or very wide), and rare or pathological input scenarios. Edge case tests ensure that the kernel handles unusual shapes gracefully, without crashes or unexpected results, and that all code paths for shape handling are exercised. These tests are important for verifying robustness and generalization beyond typical use cases.
- **Invalid Tests**: Exercise all error handling, validation, and fallback branches in the matmul operator and context. Invalid tests include unsupported post-operations, data type mismatches, dimension mismatches, missing or malformed tensors, unimplemented kernels, and forced kernel selection errors. These tests verify that the implementation correctly detects and reports errors, returns failure statuses, and does not produce undefined behavior or incorrect results for invalid inputs. Negative testing is essential for ensuring reliability and safe operation in production environments.

## Key Files
* `test_matmul_ai.cpp`: Main test logic and test routing
* `gtest_utils_ai.cpp` / `gtest_utils_ai.hpp`: Parameter generation, tensor creation, post-op configuration, and test utilities

## How to Run
1. Build the test suite using CMake and your preferred compiler.
2. Run the tests with your test runner (e.g., `ctest`, `gtest` binary).
3. Review output logs and coverage reports for validation and debugging.

## Coverage Goals
- All matmul operator/context/kernel code paths exercised
- All supported data types and post-ops covered
- Robust negative/invalid case testing

## Contact
For issues, improvements, or questions, contact the ZenDNNL Development Team.
